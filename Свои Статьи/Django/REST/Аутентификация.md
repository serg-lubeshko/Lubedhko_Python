# **Аутентификация**

1 urls.py

```python
urlpatterns = [
    path('admin/', admin.site.urls),
    path('api/v1/base-auth/', include('rest_framework.urls')), # простой вариант, не самый лучший даст куку с номером сессии
    path ("api/v1/cars/", include("cars.urls"))
]

```

2. **Permission. Делаем чтоб  редактировать запись мог кто ее создал.**

```python
   from rest_framework import permissions
   
   class IsOwnerOrReadOnly(permissions.BasePermission):
       def has_object_permission(self, request, view, obj):
           if request.method in permissions.SAFE_METHODS:
               return True
           return obj.user == request.user
```

   

3. Идем во view

   ```python
   from rest_framework import generics
   from cars.serializers import CarDetailSerializer, CarListSerializer
   from cars.models import Car
   from cars.permission import IsOwnerOrReadOnly #
   from rest_framework.permissions import IsAuthenticated #
   
   
   class CarDetailView(generics.RetrieveUpdateDestroyAPIView):
       serializer_class = CarDetailSerializer
       queryset = Car.objects.all()
       permission_classes = [IsOwnerOrReadOnly,]     #Другой пользователь ничего не исправит
       
   #А так
   class CarsListView(generics.ListAPIView):
       serializer_class = CarListSerializer
       queryset = Car.objects.all()
       permission_classes = [IsAuthenticated,]   #Посмотрит любой, кто авторизован
   ```

   

4. setting.py ! Удобно не надо во вьюхах писать пермишины

   ```python
   REST_FRAMEWORK = {
       'DEFAULT_AUTHENTICATION_CLASSES': [
           'rest_framework.authentication.BasicAuthentication',
           'rest_framework.authentication.SessionAuthentication',
           'rest_framework.authentication.TokenAuthentication',
       ]
   }
   
   ```

   